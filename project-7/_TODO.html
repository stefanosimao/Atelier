<html><head><title>exercises/7-fetch</title><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Fira+Sans|Fira+Mono"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.0/build/styles/default.min.css"><style>body,* {font-family: "Fira Sans";scroll-behavior: smooth;}body {margin: 1em;}#usi-logo {width: 75px;height: 75px;}header {display: flex;align-content: space-between;width: 100%;justify-items: center;}header ul {list-style: none;}header .title {flex: 1;margin-left: 1em;}html {min-height: 100vh;}pre,code {font-family: "Fira Mono"}pre {background: rgb(202, 227, 255);padding: 1em;}td {text-align: center}td:last-child {text-align: left;}th {font-weight: normal;color: rgb(0, 61, 131);border-bottom: 1px solid #003d83;}table {width: 100%}table tr:hover {background-color: rgb(151, 195, 236);}span.task {display: inline-flex;border-radius: 50%;border: 1px solid white;background: #ffbc00;width: 4em;height: 4em;justify-content: center;align-items: center;font-weight: normal;margin-top: 2em;}.deadline {text-align: right;}p.deadline {font-size: 2em;}.deadline b {border-bottom: 1px solid black;}span.get {font-weight: bold; color: #43a047;}span.post {font-weight: bold; color: #F3C142;}span.delete {font-weight: bold; color: #FF0000;}span.put {font-weight: bold; color: #4a90e2;}span.patch {font-weight: bold; color: #666666;}</style></head><body><header>    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="usi-logo" x="0px" y="0px" width="200" height="200" viewBox="0 0 200 200" style="enable-background:new 0 0 200 200;" xml:space="preserve" class="injected-svg svg"><g><path d="M180,41.7h-51.1V31.1h42.2C153.1,12.5,127.8,1,99.9,1C45.2,1.1,0.9,45.4,1,100.1c0,26.8,10.7,51.1,28.1,68.9   c-1.4-2-2.4-4.1-3-6.1c-1-3.5-1-5.9-1.1-15.8v-47.1h14.8v48.5c0,3.4-0.1,6.6,1,9.6c3,7.6,11.3,8.5,16,8.5c2.3,0,8.3-0.1,12.6-3.9   c4.4-3.9,4.4-8.4,4.4-15v-47.7h14.9v49.7c-0.1,8.9-0.1,16.3-8.5,23.5c-8,7-18.4,7.7-23.8,7.7c-4.8,0-9.5-0.6-14-2.1   c-1.8-0.6-3.5-1.4-5-2.3c17.1,14,39,22.4,62.8,22.4c54.7-0.1,99-44.4,98.9-99.1C199,78.1,191.9,58,180,41.7z M175.3,94.4l-6.3-9   c2.1-1.4,8.7-5.7,8.7-17.7c0-2-0.2-4.1-1-6.2c-1.7-4.1-4.6-4.9-6.6-4.9c-3.6,0-4.9,2.5-5.7,4.3c-0.5,1.3-0.6,1.5-1.8,6.6l-1.5,6.9   c-0.9,3.6-1.3,5.4-2,7.2c-1.1,2.6-4.5,9.6-14,9.6c-10.9,0-17.8-9.2-17.8-22.6c0-12.3,6.1-19,11.6-23l6.6,8.8   c-2.8,1.9-8.5,5.7-8.5,14.8c0,5.8,2.6,10.8,7,10.8c4.9,0,5.8-5.3,6.8-10.5l1.3-5.9c1.6-7.7,4.8-18.6,17-18.6   c13.1,0,18.4,12.2,18.4,24.3c0,3.2-0.3,6.7-1.3,10.2C185.1,83.4,182.3,90.1,175.3,94.4z"></path></g></svg><div class="title"><h2>Web Atelier 2021</h2><h1>Exercise  7 - Single-Page Web Applications with Fetch and Client-side Views</h1></div><div class="deadline"><p>4.11.2021</p><p class="deadline">Deadline: <b>12.11.2021</b></p></div><ul><li>Prof. Cesare Pautasso</li><li>Dr. Andrea Gallidabino</li><li>Susanna Ardig&ograve;</li><li>Fabio Di Lauro</li><li>Souhaila Serbout</li><li>Abdalazim Nouran Ayman Roushdy </li></ul></header><aside><h1>GitHub Classroom: <a href="https://classroom.github.com/a/8Gbl5OqV">Invite Link</a></h1></aside><h1 id="goal">Goal</h1>
<p>In this exercise you will integrate the client-side and server-side of the music application.</p>
<p>To solve this exercise you will need to run JavaScript both in the Web browser and in the Web server.</p>
<p>The Web Atelier mUSIc application should implement the following features:</p>
<ol>
<li>upload, download and delete song files</li>
<li>play individual songs</li>
<li>organize songs by genre, artist and album</li>
<li>select or unselect favourite songs</li>
<li>filter favourite songs</li>
<li>edit song title, description, artist,  album, genre, quality rating</li>
<li>add and remove songs from the playlist</li>
<li>play songs following the playlist (with repeat option)</li>
</ol>
<p>The Web Atelier mUSIc also supports the following extra-functional requirements:</p>
<ul>
<li>Persistent storage: the content is stored persistently using a database and survives both browser and server restarts</li>
<li>Single page application: the content is dynamically loaded and rendered directly in the browser</li>
</ul>
<p>Developer Productivity Hint: <strong>do not start solving this assignment from scratch</strong>, but reuse as much as possible from your previous assignment solutions.</p>
<h3 id="compiling-views">Compiling Views</h3>
<p>To automatically synchronize the compiled views when the server starts, simply add</p>
<pre><code class="language-js">require(<span class="hljs-string">&quot;./ejs-compile&quot;</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>in your <code>app.js</code></p>
<h2 id="task---music-player"><span class='task'>Task 1.</span>  Music Player</h2>
<p>Place the player to the footer of the page. The player buttons should be permanently displayed. </p>
<p>Clicking on any song link will stop the currently playing song and start playing the new song.</p>
<p>It should still be possible to add songs to the player playlist, which will be managed using <code>localStorage</code> as in Exercise 3.</p>
<h2 id="task---upload-song"><span class='task'>Task 2.</span>  Upload Song</h2>
<p>The upload song form should also be displayed on the same page after the user clicks on the corresponding link. Submitting it should not reload the page. After the song is loaded, the song table section should be refreshed by re-rendering the view on the client side and showing the newly uploaded song metadata.</p>
<h2 id="task---edit-song-metadata"><span class='task'>Task 3.</span>  Edit Song Metadata</h2>
<p>Clicking on the edit button for the song should open the editor form on the same page. </p>
<p>Submitting the edit form should not reload the page. Instead, a <code><span class='put'>PUT</span></code> or <code><span class='patch'>PATCH</span></code> request should be sent to update the corresponding song metadata stored on the server. </p>
<p>It should be possible to close (i.e., hide) the edit form without submitting it.</p>
<h2 id="task---delete"><span class='task'>Task 4.</span>  Delete</h2>
<p>It should be possible to delete each song individually by clicking on the corresponding button. After the song is successfully deleted from the server, the corresponding DOM element should be removed from the page without having to re-render the rest of the page content.</p>
<h2 id="task---browse"><span class='task'>Task 5.</span>  Browse</h2>
<p>Dynamically filter the song table by genre, artist and album on the client. Do not reload the page as the filter selected by clicking on links changes. </p>
<!-- Should you reload the song collection from the server every time the filter changes? Only reload the song collection if the copy stored on the browser is older than 10 seconds. -->

<h2 id="task---search"><span class='task'>Task 6.</span>  Search</h2>
<p>Add a search field to display only the songs whose title, artist, album or description contain the specified text as soon as the text changes. The filtering should be implemented on the client based on the already displayed song table (which may or not be filtered by genre, artist, album)</p>
<p><em>Hint:</em> Look at the handson video for an example on how to implement client-side search.</p>
<h2 id="task---address-bar"><span class='task'>Task 7.</span>  Address Bar</h2>
<p>Share the current view with a link. Use the browser address bar to store which view is currently displayed.</p>
<p>For example, the following URL fragments correspond to the views implemented as part of the previous tasks:</p>
<pre><code><span class="hljs-meta">#upload</span>
<span class="hljs-meta">#edit/:id</span>
<span class="hljs-meta">#songs</span>
<span class="hljs-meta">#songs/genre/:genre</span>
<span class="hljs-meta">#songs/album/:album</span>
<span class="hljs-meta">#songs/artist/:artist</span>
<span class="hljs-meta">#songs/search/:text</span>
</code></pre>
<p>As the user navigates between the various views, the address bar should be updated to reflect the current view.</p>
<p>If the application is loaded from a link that includes the fragment (when copying and pasting the browser address bar) the initial view should reflect the content of the URI fragment.</p>
<h2 id="task---optional-tasks"><span class='task'>Task 8.</span>  Optional Tasks</h2>
<ol>
<li>Update the browser navigation history to track application view changes.</li>
<li>Sort the table content based on different criteria.</li>
<li>Shuffle the playlist</li>
<li>Autocomplete the form fields based on the existing values present in the database.</li>
<li>Edit the metadata of multiple songs at once. Only update the fields which have changed (e.g., to rename the album without modifying the titles)</li>
<li>Keep track of play statistics. For each song, how many times the song has been started, how many times it has been listened until the end, how many times it has been skipped by the user (this requires to extend the database and the API routes)</li>
</ol>
<h2 id="mastery-check-topics">Mastery Check Topics</h2>
<p>Solving this exercise will demonstrate mastery for the following topics:</p>
<ul>
<li>4. APIs<ul>
<li>4.1. Browser  <ul>
<li>4.1.2. DOM  <ul>
<li>4.1.2.7. preventDefault    </li>
</ul>
</li>
<li>4.1.8. HTTP Client (Fetch)<ul>
<li>4.1.8.1. HTTP methods</li>
<li>4.1.8.2. JSON upload/download</li>
<li>4.1.8.3. FormData</li>
</ul>
</li>
<li>4.1.9. Navigation history  </li>
</ul>
</li>
<li>4.2. Server  <ul>
<li>4.2.5. EJS  <ul>
<li>4.2.5.4. Precompiled views</li>
<li>4.2.5.5. Client-side rendering</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<footer></footer></body></html>